@startuml MOK_ejb_cdi_diagram
left to right direction

package pl.lodz.p.it.ssbd2022.common {
    abstract class AbstractFacade {
        -Class<T> entityClass
        +AbstractFacade(Class<T> entityClass)
        #{abstract} EntityManager getEntityManager()
        #{abstract} void HashAlgorithm getHashAlgorithm()
        +void create(T entity)
        +void edit(T entity, String eTag)
        +void unsafeEdit(T entity)
        +void remove(T entity, String eTag)
        +void unsafeRemove(T entity)
        +T find(Object id)
        +List findAll()
        +PaginationData findInRange(int pageNumber, int perPage)
        +int count()
        -void verifyTag(AbstractEntity entity, String eTag)
    }

    abstract class AbstractManager {
        #SessionContext sessionContext
        #Logger logger
        -String transactionId
        -boolean lastTransactionCommited
        +boolean isLastTransactionCommited()
        +void afterBegin()
        +void beforeCompletion()
        +void afterCompletion()
    }

    interface ManagerLocalInterface <<Interface>> {
        +boolean isLastTransactionCommited();
    }
}


package pl.lodz.p.it.ssbd2022.mok {

    ' ENDPOINTY
    package cdi.endpoints {
        interface MOKEndpointInterface <<Interface>> {
        }

        class MOKEndpoint {
                
        }           
    }

    ' FASADY
    package ejb.facades {

        class AccessLevelFacade {}

        class AccountFacade {}
        
        class ActiveAccountFacade {}

        class ResetPasswordFacade {}

    }

    ' SERWISY
    package ejb.services {

        interface MOKServiceInterface <<Interface>> {}

        class MOKService {}

    }
    
}

' extend fasad
AbstractFacade <|- AccessLevelFacade
AbstractFacade <|- AccountFacade
AbstractFacade <|- ActiveAccountFacade
AbstractFacade <|- ResetPasswordFacade

' extend/implement serwis
AbstractManager <|- MOKService
ManagerLocalInterface <|- MOKServiceInterface
MOKServiceInterface <|- MOKService

' implement endpoint
MOKEndpointInterface <|- MOKEndpoint

' wykorzystanie serwisu przez endpoint
MOKEndpoint -> MOKService

' wykorzystanie fasady przez serwis
MOKService -> AccessLevelFacade
MOKService -> AccountFacade
MOKService -> ActiveAccountFacade
MOKService -> ResetPasswordFacade


@enduml